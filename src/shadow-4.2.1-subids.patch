---src/Makefile.am	Thu May 08 17:43:11 2014
+++ src/Makefile.am	Wed Jan 25 15:39:29 2017
@@ -52,7 +52,10 @@
 noinst_PROGRAMS = id sulogin
 
 suidbins       = su
-suidubins      = chage chfn chsh expiry gpasswd newgrp passwd newuidmap newgidmap
+suidubins      = chage chfn chsh expiry gpasswd newgrp passwd
+if ENABLE_SUBIDS
+	suidubins += newuidmap newgidmap
+endif
 if ACCT_TOOLS_SETUID
 	suidubins += chage chgpasswd chpasswd groupadd groupdel groupmod newusers useradd userdel usermod
 endif
--- src/Makefile.in	Sat May 10 01:49:48 2014
+++ src/Makefile.in	Wed Jan 25 15:39:13 2017
@@ -505,7 +505,10 @@
 	-I$(top_srcdir)/libmisc
 
 suidbins = su
-suidubins = chage chfn chsh expiry gpasswd newgrp passwd newuidmap newgidmap
+suidubins = chage chfn chsh expiry gpasswd newgrp passwd
+ifdef ENABLE_SUBIDS
+	suidubins += newuidmap newgidmap
+endif
 @WITH_TCB_TRUE@shadowsgidubins = passwd
 LDADD = $(INTLLIBS) \
 		 $(LIBTCB) \
--- src/usermod.c.org	Wed Jan 25 14:46:05 2017
+++ src/usermod.c	Wed Jan 25 14:44:45 2017
@@ -1360,7 +1360,7 @@
 		         Prog, (unsigned long) user_newid);
 		exit (E_UID_IN_USE);
 	}
-
+#ifdef ENABLE_SUBIDS
 	if (   (vflg || Vflg)
 	    && !is_sub_uid) {
 		fprintf (stderr,
@@ -1376,6 +1376,7 @@
 		         Prog, sub_gid_dbname (), "-w", "-W");
 		exit (E_USAGE);
 	}
+#endif	
 }
 
 /*

